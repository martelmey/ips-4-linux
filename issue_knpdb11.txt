##  dev-hial1.sh
### PROBLEM: pkg broken
##

root@dev-hial1:~# pkg update
pkg: 0/1 catalogs successfully updated:


http protocol error: Unknown error code: 403 reason: Forbidden
URL: 'http://localhost:1008/solaris/cd5f859ae60848b1316dffc9131991a8dcad0e4f/catalog/1/catalog.attrs'

##################
##################
##Cannot try to re-add origin under different pub name:
root@dev-hial1:~# pkg set-publisher -k /root/pkg.oracle.com.key.pem \
> -c /root/pkg.oracle.com.certificate.pem \
> -G "*" \
> -g https://pkg.oracle.com/solaris/support/ \
> --proxy http://192.168.60.250:8008 \
> solaris1

One or more of the repository origin(s) listed below contains package data for solaris; not solaris1:

https://pkg.oracle.com/solaris/support/

This is either because one of the repository origins is not valid for this publisher, or because the list of known publishers retrieved from the repository origin does not match the client.

##################
##################
##Cannot remove bad URI:
root@dev-hial1:~# pkg set-publisher -G http://localhost:1008/solaris/ solaris
Unknown repository origin 'http://localhost:1008/solaris/'

root@dev-hial1:~# pkg set-publisher -G http://localhost:1008/solaris/cd5f859ae60848b1316dffc9131991a8dcad0e4f/catalog/1/catalog.attrs solaris
Unknown repository origin 'http://localhost:1008/solaris/cd5f859ae60848b1316dffc9131991a8dcad0e4f/catalog/1/catalog.attrs/'

root@dev-hial1:~# pkg set-publisher -G https://pkg.oracle.com/solaris/support/ solaris
pkg: 0/1 catalogs successfully updated:

root@dev-hial1:~# pkg set-publisher -G http://localhost:1008/solaris/cd5f859ae60848b1316dffc9131991a8dcad0e4f/ solaris
Unable to remove origin 'http://localhost:1008/solaris/cd5f859ae60848b1316dffc9131991a8dcad0e4f/' since it is provided by the system repository.


##################
##################
##Cannot remove good URI either, it hits bad URI first again:
root@dev-hial1:~# pkg set-publisher -G https://pkg.oracle.com/solaris/support/ solaris
pkg: 0/1 catalogs successfully updated:
http protocol error: Unknown error code: 403 reason: Forbidden
URL: 'http://localhost:1008/solaris/cd5f859ae60848b1316dffc9131991a8dcad0e4f/catalog/1/catalog.attrs'

This got rid of good URI:
pkg set-publisher -G "*" solaris

##################
##################
##Works in PS.
martel.meyers@kdcps-hial-wls1:~$ sudo pkg publisher solaris

            Publisher: solaris
                Alias:
           Origin URI: http://localhost:1008/solaris/d128a99fd3947168959e98b71186ac07b91ad444/
           Origin Status: Online
              SSL Key: None
             SSL Cert: None
          Client UUID: a5897616-c55b-11ea-86f8-d98f5a4ad2c3
      Catalog Updated: November 19, 2019 at 11:36:59 PM
              Enabled: Yes
martel.meyers@kdcps-hial-wls1:~$ sudo pkg publisher exa-family

            Publisher: exa-family
                Alias:
           Origin URI: http://localhost:1008/exa-family/4638c1202aeb1b6083b5bd9a4ccf928bce181e13/
           Origin Status: Online
              SSL Key: None
             SSL Cert: None
          Client UUID: ac972c32-c55b-11ea-86fb-d98f5a4ad2c3
      Catalog Updated: November 19, 2019 at 10:39:12 PM
              Enabled: Yes
